## 周报 - 祁迪 - 2016/12/7
### ​本周主要工作任务
1. RN框架层面工作

2. 泡泡RN相关工作

3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
  1. 评估接入https对RN的影响 -Doing

  2. RN截屏组件 -Done

  3. 线上性能数据分析 -Done
    - 页面启动时间对比
    - 页面启动次数对比

  4. 线上Crash数据分析
    - 断网异常堆栈
    <br>&emsp;正常用户Case，可以忽略

    ~~~
    Ensure the following:
      Node server is running and available on the same network - run 'npm start' from react-native root
      Node server URL is correctly set in AppDelegate

    URL: http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js" UserInfo={NSUnderlyingError=0x13ed55e50 {Error Domain=NSURLErrorDomain Code=-1005 "网络连接已中断。" UserInfo={NSUnderlyingError=0x13e934470 {Error Domain=kCFErrorDomainCFNetwork Code=-1005 "(null)" UserInfo={_kCFStreamErrorCodeKey=57, _kCFStreamErrorDomainKey=1}}, NSErrorFailingURLStringKey=http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js, NSErrorFailingURLKey=http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js, _kCFStreamErrorDomainKey=1, _kCFStreamErrorCodeKey=57, NSLocalizedDescription=网络连接已中断。}}, NSLocalizedDescription=Could not connect to development server.

    Ensure the following:
    - Node server is running and available on the same network - run 'npm start' from react-native root
    - Node server URL is correctly set in AppDelegate

    URL: http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js, NSLocalizedFailureReason=网络连接已中断。}----------XCRASH_END----------" 0.001​
    ~~~

    - 业务数据空保护
    <br>&emsp;业务方没有对网络数据空保护，他们会负责修改

    ~~~
    ----------XCRASH_BEGIN----------
    Error Domain=RCTErrorDomain Code=1 "Unhandled JS Exception: ReferenceError: Can't find variable: document" UserInfo={NSLocalizedFailureReason={"line":1,"column":43,"sourceURL":"http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js"}, NSLocalizedDescription=Unhandled JS Exception: ReferenceError: Can't find variable: document, RCTJSStackTraceKey=(
            {
            column = 0;
            file = "http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js";
            lineNumber = 1;
            methodName = "";
        }
    )}
    ----------XCRASH_END----------"
    ~~~

    - "Can't find variable: document/window"
    <br>&emsp;RN Runtime没有document和window对象，Review过泡泡的RN业务代码，没有发现任何问题。目前猜测是Bundle Url被运营商劫持，注入了H5代码导致RN Runtime出现异常。

    ~~~
    "----------XCRASH_BEGIN----------
    Error Domain=RCTErrorDomain Code=0 "Unhandled JS Exception: null is not an object (evaluating 't.monthSigns')" UserInfo={RCTJSStackTraceKey=(
            {
            column = 2755;
            file = "http://static.iqiyi.com/js/demo/PaopaoSignCalenderRN/index.ios.bundle.js";
            lineNumber = 12;
            methodName = value;
        },
        ...
    ), NSLocalizedDescription=Unhandled JS Exception: null is not an object (evaluating 't.monthSigns')}
    ----------XCRASH_END----------"
    ~~~

  5. 离线Bundle逻辑完善 -Done

  6. 发布CDN、清除CDN缓存脚本 -Doing

#### 泡泡RN相关工作
  1. 截屏组件集成 -Done
  2. 接入离线Bundle管理 -Done
  3. RCTEventDispatch接口 -Doing
  4. RN页面加载异常时的错误处理机制 -Doing

#### 漫画RN相关工作
  1. 转屏问题 -Doing
  2. 接入离线Bundle管理 -Done
  3. 首屏速度 -Doing
  4. 启动时间统计问题修复 -Done
  5. 业务数据在真机请求问题 -Doing


======================================================================================

## 周报 - 祁迪 - 2016/12/14
### ​本周主要工作任务
  1. RN框架层面工作

  2. 泡泡RN相关工作

  3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
  1. Crash投递逻辑修改 -Done
  2. 漫画离线包逻辑修改

#### 泡泡RN相关工作
  1. 符号冲突问题
  2. Bundle发布、RCTLog符号导出问题
  3. 基线保存二维码Crash问题
  4. 动效Bug

#### 漫画RN相关工作
  1. 合并基线
  2. Bug Review
  3. 预加载Bundle异常捕获问题 -Done
  4. 静态库打包问题 -Done
  5. Loading动效消失逻辑优化
  6. 预加载Bundle时机修改 -Done
  7. pingback

======================================================================================

## 周报 - 祁迪 - 2016/12/21
### ​本周主要工作任务
  1. RN框架层面工作

  2. 泡泡RN相关工作

  3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
  1. 稳定性
    - ASyncLocalStorage Native接口
    - React Native Upstream Crash Fix
  2. 兼容性
    - iOS 7 漫画入口屏蔽，测试 ----------------TODO
  3. 离线包上线测试 (张超)
  4. 弱网下拉刷新高频率Crash，问题修复
  5. RN模板工程/Playground
  6. RN图片组件
  7. 修复首屏性能统计问题
  8. React Native业务实践

#### 泡泡RN相关工作
  1. 泡泡部分图片切换到https

#### 漫画RN相关工作
  1. 稳定性
    - 预加载Bundle RN异常捕获问题
    - 注册制预加载Bundle云控，防止APP启动就Crash，测试开关(关闭状态的话，可以正常关闭预加载逻辑，可以正常进入漫画业务)
    - 预加载Bundle发生异常的话，Bridge对象清理，测试
    - 漫画首页下拉刷新高频崩溃
    - RCTEventEmitter Crash
    - 阅读器僵死后崩溃
  2. 兼容性
    - 图片Blur Crash问题, iOS 8必现, 使用RN官方Image组件的blurRadius属性代替
    - iOS 7 基线APP启动必现Crash
    - RCTTransformImage Crash问题
    - iOS 7 列表高概率Crash问题
    - iOS 10 分类搜索列表页面图片加载不出来
    - RNTableView兼容性问题
    - RN 页面 Reload 接口  -Doing
    - RN Image 组件实现：Fix 图片Cancel Load Crash问题，图片延迟加载
  3. Bug Review

~~~
top-2 crash
--------------------------------------------------------------------------------------
crash count         : 22 (9.82%)
crash module        : unknown
crash point         : RCTTransformImage + 29976
blame name          : unknown
blame jira          : unknown
blame email         : unknown@qiyi.com
url arguments       : &uid=4BB9B3A3-A2AA-4735-95BB-231EE01E1D6C&crpo=1&ip=202.108.14.15&crplg=8&ct=1&crshid=0&albumid=&pf=2&net=1&type=50318_2&po=1&tm1=&v=8.0&crashtp=1&tm3=&uploadid=&pla=32&mkey=8e48946f144759d86a50075555fd5862&date_time=2016-12-14 16:34:58&tm2=&p1=221&tm4=&tvid=-&cid=&ua=iPhone5,3&crplgv=null&st=&p=22&othdt=null&inited=1&os=7.0
thread name         : com.facebook.react.JavaScript, num = 13
exception name      : Signal Exception
exception reason    : Signal 11 was raised!
build version       : 20160504212600
used memory         : 68.05M (6.70%)
total memory        : 1015.66M
disk space          : 13.31G
disk free space     : 4.96G (37.27%)
startup time        : 2016-12-14 07:32:22 +0000
crash time          : 2016-12-14 07:32:26 +0000

backtrace
---------
0   iQiYiPhoneVideo                     0x02be769b xcrash_exception_handler + 804
1   iQiYiPhoneVideo                     0x02be9819 xcrash_signal_handler + 28
2   libsystem_platform.dylib            0x37f6b723 _sigtramp + 42
3   JavaScriptCore                      0x2e7b1b31 WTFPrintBacktrace + 128
4   JavaScriptCore                      0x2e60b987 JSObjectSetProperty + 414
5   JavaScriptCore                      0x2e773ac7 <redacted> + 722
6   JavaScriptCore                      0x2e7737db <redacted> + 26
7   iQiYiPhoneVideo                     0x01b64a87 RCTTransformImage + 29976
8   iQiYiPhoneVideo                     0x01b65167 RCTTransformImage + 31736
9   iQiYiPhoneVideo                     0x01b6443b RCTTransformImage + 28364
10  iQiYiPhoneVideo                     0x01b63f4d RCTTransformImage + 27102
11  iQiYiPhoneVideo                     0x01b64081 RCTTransformImage + 27410
12  iQiYiPhoneVideo                     0x01b3f8b7 RCTSetFatalHandler + 24442
13  iQiYiPhoneVideo                     0x01b3f1d7 RCTSetFatalHandler + 22682
14  iQiYiPhoneVideo                     0x01b65167 RCTTransformImage + 31736
15  Foundation                          0x2e043fdb <redacted> + 386
16  CoreFoundation                      0x2d62af27 <redacted> + 14
17  CoreFoundation                      0x2d62a3ef <redacted> + 206
18  CoreFoundation                      0x2d628bdf <redacted> + 630
19  CoreFoundation                      0x2d593541 CFRunLoopRunSpecific + 524
20  CoreFoundation                      0x2d593323 CFRunLoopRunInMode + 106
21  iQiYiPhoneVideo                     0x01b61b9d RCTTransformImage + 17966
22  Foundation                          0x2e043dc7 <redacted> + 1062
23  libsystem_pthread.dylib             0x37f6fc5d <redacted> + 140
24  libsystem_pthread.dylib             0x37f6fbcf _pthread_start + 102
25  libsystem_pthread.dylib             0x37f6dcd0 thread_start + 8

architecture
------------
22      (100.00%):	armv7

os version
----------
22      (100.00%):	7.0
~~~


======================================================================================

## 周报 - 祁迪 - 2016/12/28
### ​本周主要工作任务
  1. RN框架层面工作

  2. 泡泡RN相关工作

  3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
  1. React Native业务实践与框架产品化 PPT
  2. FlexBox layout algorithm   (Yoga 排版引擎 / CSSLayout 排版引擎)
  3. 本地存储组件
  4. RN模板工程

#### 泡泡RN相关工作
  1. 接入离线Bundle
  2. 离线Bundle上测试环境

#### 漫画RN相关工作
  1. 协助解决Bug、卡顿
  2. 上线，稳定性问题关注，性能数据
  3. 离线Bundle上线

======================================================================================

## 周报 - 祁迪 - 2017/1/3
### ​本周主要工作任务
  1. RN框架层面工作

  2. 泡泡RN相关工作

  3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
  1. React Native业务实践与框架产品化 PPT
  2. 本地存储组件
  3. RN模板工程

#### 泡泡RN相关工作

#### 漫画RN相关工作
  1. Jenkins Release Job

======================================================================================

## 周报 - 祁迪 - 2017/1/10
### ​本周主要工作任务
  1. RN框架层面工作

  2. 泡泡RN相关工作

  3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
  1. 整理发布、部署平台，应对更多业务接入
  2. Bundle Exception Reload功能
  3. RN 框架增加云控配置功能
  4. RN图片组件支持默认图

#### 泡泡RN相关工作
  1. 循环引用问题
  2. 小程序咨询
  3. 更多业务接入RN

#### 漫画RN相关工作
  1. 观察线上数据: Crash、首屏时间
  2. PPS Crash问题

======================================================================================

## 周报 - 祁迪 - 2017/1/17
### ​本周主要工作任务
  1. RN框架层面工作
    - Bundle管理方式调整
    - SearchBar组件定制
    - RNTableView组件定制

  2. 泡泡RN相关工作
    - 日历页面崩溃问题
    - 8.2版本需求讨论

  3. 漫画RN相关工作
    - 分享回调接口
    - 默认图显示调整
    - Bundle加载异常通知

  4. 参加 WeexConf

### 任务详情
#### RN框架层面工作
1. Bundle管理方式调整
</br>目前业务方部署iOS的RN Bundle有两种方式：
    - CMS上传生成CDN外链，然后通过URL直接加载；
    - 上传离线包到Bundle管理后台，通过离线包的方式加载；

&emsp;&emsp;因为CMS上传会有大小限制，所以后面将不支持这种部署方式。跟业务方讨论后，从8.2版本开始我们会把业务Bundle预埋到App里面，至于热更新会通过Bundle管理后台的方式支持。

2. SearchBar组件定制
</br>解决一些遗留问题，另外现有组件不满足泡泡的业务需求，根据泡泡同事的需求；定制了现有SearchBar组件，主要包括：定制SearchBar高度、图标、文字颜色等

2. RNTableView组件定制
</br>根据泡泡同事的需求；提供TableView Cell选中效果的定制接口


#### 泡泡RN相关工作
1. 日历页面崩溃问题

  排查朱洲反馈的一个问题，原因是泡泡原生代码导致的，泡泡的同事会处理

2. 8.2版本需求讨论

  泡泡iOS会在8.2版本上几张页面，跟他们讨论了一些UI组件的使用方式

#### 漫画RN相关工作
1. 分享回调接口

  RN JS调用基线分享功能，分享成功以后需要通过callback通知分享渠道，便于做Pingback

2. 默认图显示调整

  调整RN图片组件的参数，在显示默认图的时候图片要居中，显示正常图片的时候需要平铺拉伸

3. Bundle加载异常通知

  区分JSBundle加载异常和运行异常

#### 参加 WeexConf
几个可以确定的消息:
1. Weex是基于RN慢慢演化过来的
2. Weex框架是由一个30人+的技术团队，建立在阿里移动技术框架(比如阿里移动容器框架Atalas、前端技术体系、网络接入服务ACCS等)的基础上，专门针对双十一会场的场景优化的
3. 目前没有其他公司使用Weex构建大规模应用场景

几点个人感受:
1. 宣传力度比较大，实际框架层面优化的干货并不多
2. Weex的三端统一、API标准化、工具链、研发支撑体系做的相对较好
3. Weex不一定适用于我们的应用场景，基于RN框架结合业务实践慢慢积累形成一套自己的动态化方案更靠谱
4. 在保障框架稳定的基础上，我们需要在平台化、研发支撑投入更多精力

======================================================================================

## 周报 - 祁迪 - 2017/1/17
### ​本周主要工作任务
  1. RN框架层面工作
    - WeexConf 总结
    - RCTTouchEvent eventID 冲突问题
    - 完善研发支撑链路
      - React Native 私有npm服务
      - Playground 完善
    - 多业务Bundle预加载和缓存
    - Bundle预埋解决方案
    - 手游直播 iOS

  2. 泡泡RN相关工作
    - 预埋Bundle方案讨论

  3. 漫画RN相关工作

### 任务详情
#### RN框架层面工作
1. WeexConf 总结
</br>总结了Weex"动态化框架"的总体解决方案，整理了业务支撑和框架层面所做的工作。

2. RN框架层面对手势交互的处理有个Bug：列表页面的每个Cell如果有多个对象监听Touch事件的时候，会发生RCTTouchEvent eventID 冲突，导致崩溃。

3. React Native 私有npm服务
</br>搭建React Native开发环境，是业务方需要做的第一件事情，尽管官方文档描述的很简单。但实际操作起来有很多坑，比如初始化项目非常慢、私有组件管理混乱等。

4. Playground 完善
</br>跟甘泉讨论完善基础UI组件和API的方案，在Playground中加了GifView、SearchBar、ListView下拉刷新等业务组件的Demo

#### 泡泡RN相关工作

#### 漫画RN相关工作

======================================================================================

## 周报 - 祁迪 - 2017/2/3
### ​本周主要工作任务
  1. RN框架层面工作
    - 完善研发支撑链路
      - React Native 私有npm服务
      - Playground 完善
    - 多业务Bundle预加载和缓存
    - RN框架升级

  2. 泡泡RN相关工作

  3. 漫画RN相关工作
    - 修复WebImage组件圆角问题

### 任务详情
#### RN框架层面工作
1. React Native 私有npm服务

2. RN框架升级
</br>iOS和Android尽量保证代码一致，我们讨论后决定把框架层代码升级到0.41版本，因为iOS RN页面较多，框架层面改动较多，工作量稍大：
  - JS Bundle打包
  - 头文件引入方式

#### 泡泡RN相关工作

#### 漫画RN相关工作

======================================================================================

## 周报 - 祁迪 - 2017/2/3
### ​本周主要工作任务
  1. RN框架层面工作
    - 完善研发支撑链路
      - React Native 私有npm服务
      - Playground 完善
    - 多业务Bundle预加载和缓存
    - Android支持加载在线bundle

  2. 泡泡RN相关工作

  3. 漫画RN相关工作
    - SearchBar组件定制
    - 下拉刷新组件定制

### 任务详情
#### RN框架层面工作
1. React Native 私有npm服务

#### 泡泡RN相关工作

#### 漫画RN相关工作
